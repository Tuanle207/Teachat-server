(this["webpackJsonpteachat-client"]=this["webpackJsonpteachat-client"]||[]).push([[0],{12:function(e,t,a){e.exports=a.p+"static/media/sprite.e802de9a.svg"},148:function(e,t,a){},158:function(e,t,a){e.exports=a.p+"static/media/rain-scene-medium.410acbcd.mp4"},191:function(e,t,a){e.exports=a(401)},294:function(e,t,a){},295:function(e,t,a){},296:function(e,t,a){},328:function(e,t){},347:function(e,t,a){},385:function(e,t,a){},386:function(e,t,a){},387:function(e,t,a){},388:function(e,t,a){},389:function(e,t,a){},390:function(e,t,a){},391:function(e,t,a){},392:function(e,t,a){},393:function(e,t,a){},394:function(e,t,a){},395:function(e,t,a){},396:function(e,t,a){},397:function(e,t,a){},400:function(e,t,a){},401:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(72),s=a.n(c),o=a(17),i=a(5),u=a(151),l=a(27),p="SUCCEED_LOGIN",m="FAIL_LOGIN",d="LOG_OUT",h="FAIL_REQUEST",f="ADD_FRIEND_ID",g="GET_FRIENDS_LIST",v="START_CHAT",E="CREATE_CHAT",b="GET_MESSAGESA",_="SEND_MESSAGE",y="RECEIVE_MESSAGE",O="SEARCH_FRIENDS",j="GET_FRIEND_REQUESTS",S="RECEIVE_FRIEND_REQUEST",k="ACCEPT_FRIEND_REQUEST",N="REMOVE_FRIEND_REQIEST",w="LOAD_LOGIN_FINISH",I="LOAD_CHATS_FINISH",x="LOAD_MESSAGES_FINISH",C="SHOW_FRIEND_REQUESTS",R="SHOW_USER_OPERATION",U="SHOW_EMOJI",F="SHOW_SEACH_PEOPLE",q={loggedIn:!1,user:null,error:null},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p:return Object(l.a)({},e,{loggedIn:!0,user:t.payload});case m:return Object(l.a)({},e,{error:t.payload});case f:var a=e.user;return a.friends.push(t.payload),Object(l.a)({},e,{user:a});case d:return q;default:return e}},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a={};switch(t.type){case g:return t.payload.searching?(delete t.payload.searching,t.payload):Object(l.a)({},e,{},t.payload);case _:case y:var n=t.payload.chat;return(a=Object(l.a)({},e))[n].latestMessage=t.payload,a;case E:a=Object(l.a)({},e);var r="".concat(t.payload._id);return a[r]=t.payload,a;case d:return{};default:return e}},H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:return t.payload;case d:return null;default:return e}},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a={};switch(t.type){case b:return Object(l.a)({},e,{},t.payload);case _:case y:return(a=Object(l.a)({},e))[t.payload.chat].push(t.payload),a;case d:return{};default:return e}},T={loginLoading:!0,messagesLoading:!0,chatsLoading:!0,friendRequestsShowing:!1,userOperationShowing:!1,emojiShowing:!1,searchPeopleShowing:!1},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I:case x:case w:case C:case U:case R:case F:return Object(l.a)({},e,{},t.payload);case d:return T;default:return e}},P=[],G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O:return t.payload;case h:case d:return P;default:return e}},K=a(163),Q=[],W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:return t.payload;case S:return[].concat(Object(K.a)(e),[t.payload]);case k:case N:return e.filter((function(e){return e._id!==t.payload}));case h:case d:default:return e}},V=Object(o.c)({authReducer:L,chatsReducer:A,form:u.a,currentChat:H,messages:M,UIState:D,peopleReducer:G,friendRequests:W}),J=a(154),Y=a(7),X=a(8),z=a(9),B=a(10),Z=a(48),$=a(42),ee=a(155),te=(a(294),a(295),a(158)),ae=a.n(te),ne=function(){return r.a.createElement("div",{className:"bg-video"},r.a.createElement("video",{className:"bg-video__content",autoPlay:!0,muted:!0,loop:!0},r.a.createElement("source",{src:ae.a,type:"video/mp4"}),'"Your broswer is not support!"'))},re=a(149),ce=a(150),se=(a(296),function(e){var t=e.type,a=e.text,n=(e.link,e.className);return"button"===t?r.a.createElement("button",{type:"submit",className:"btn ".concat(n)},a):r.a.createElement(Z.b,{to:"/login",className:"a-btn ".concat(n)},a)}),oe=a(18),ie=a.n(oe),ue=a(30),le=a(75),pe=a.n(le),me=a(160),de=a.n(me).a.connect("http://localhost:5000/"),he=a(161),fe=a.n(he).a.create({baseURL:"http://localhost:5000"}),ge=function(){return{Authorization:"Bearer "+pe.a.get("jwt")}},ve=function(){var e=Object(ue.a)(ie.a.mark((function e(t,a,n,r){var c;return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t;case 3:c=e.sent,console.log(c.data),"success"===c.data.status&&(r&&pe.a.set("jwt",c.data.token),a(n.success)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),a(n.fail);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a,n,r){return e.apply(this,arguments)}}(),Ee=function(){return function(){var e=Object(ue.a)(ie.a.mark((function e(t){var a;return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fe.post("/api/v1/users/checkLoggedIn",{},{headers:ge()});case 3:"success"===(a=e.sent).data.status&&t({type:p,payload:a.data.data.user}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t({type:m,payload:"You have not logged in yet!"});case 10:setTimeout((function(){t({type:w,payload:{loginLoading:!1}})}),1e3);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},be=function(e){return function(){var t=Object(ue.a)(ie.a.mark((function t(a){var n,r,c;return ie.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e&&(e=e.split(" ").join("-")),n="/api/v1/chats".concat(e?"/?name="+e:""),t.next=5,fe.get(n,{headers:ge()});case 5:r=t.sent,c={},r.data.data.forEach((function(e){c["".concat(e._id)]=e})),e&&(c.searching=!0),a({type:g,payload:c}),setTimeout((function(){a({type:I,payload:{chatsLoading:!1}})}),100),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),a({type:h,payload:{error:"Internal Server Error!"}});case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e){return t.apply(this,arguments)}}()},_e=function(){var e=Object(ue.a)(ie.a.mark((function e(t,a,n){var r,c;return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n().messages[t]){e.next=8;break}return e.next=4,fe.get("/api/v1/messages/".concat(t),{headers:ge()});case 4:r=e.sent,(c={})["".concat(t)]=r.data.messages,a({type:b,payload:c});case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),a({type:h,payload:{error:"Internal Server Error!"}});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,a,n){return e.apply(this,arguments)}}(),ye=function(e){return function(t){je(t),t({type:U,payload:{emojiShowing:e}})}},Oe=function(e){return function(t){je(t),t({type:F,payload:{searchPeopleShowing:e}})}},je=function(e){e({type:R,payload:{userOperationShowing:!1}}),e({type:C,payload:{friendRequestsShowing:!1}})},Se=function(e){return function(t){ke(e,t)}},ke=function(){var e=Object(ue.a)(ie.a.mark((function e(t,a){var n,r;return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t?fe.get("/api/v1/users/searchFriends?username=".concat(t),{headers:ge()}):fe.get("/api/v1/users/friends",{headers:ge()}),e.prev=1,e.next=4,n;case 4:"success"===(r=e.sent).data.status&&a({type:O,payload:r.data.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a({type:h,payload:{error:"Internal Server Error!"}});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,a){return e.apply(this,arguments)}}(),Ne=a(12),we=a.n(Ne),Ie=(a(347),function(e){Object(B.a)(a,e);var t=Object(z.a)(a);function a(){var e;Object(Y.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).onSubmit=function(t){var a=t.email,n=t.password;e.props.login(a,n)},e}return Object(X.a)(a,[{key:"renderInput",value:function(e){var t=e.input,a=(e.meta,t.name);return r.a.createElement("div",{className:"login-form__input-wrap"},r.a.createElement("label",{htmlFor:"".concat(a,"-login"),className:"login-form__label"},a),r.a.createElement("input",Object.assign({},t,{name:"".concat(a),type:"".concat(a),className:"login-form__info",placeholder:"email"===a?"Type your email address":"Type your password",id:"".concat(a,"-login"),autoComplete:"off",autoFocus:"email"===a?"on":"off"})),r.a.createElement("svg",{className:"login-form__icon"},r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-").concat("email"===a?"mail":"key")})))}},{key:"render",value:function(){return r.a.createElement("form",{className:"authen-content",onSubmit:this.props.handleSubmit(this.onSubmit)},r.a.createElement("div",{className:"authen-form"},r.a.createElement("div",{className:"authen-form__heading"},r.a.createElement("h1",{className:"authen-form__heading--title"},"Welcome to Teachat!"),r.a.createElement("p",{className:"authen-form__heading--text"},"Let's login to start!"),r.a.createElement("svg",{className:"authen-form__heading--icon"},r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-bubbles")}))),r.a.createElement("div",{className:"login-form"},r.a.createElement(re.a,{name:"email",component:this.renderInput}),r.a.createElement(re.a,{name:"password",component:this.renderInput}),r.a.createElement("div",{className:"login-form__options"},r.a.createElement("input",{type:"checkbox",name:"",className:"login-form__options__remember-check",id:"remember-me"}),r.a.createElement("label",{htmlFor:"remember-me",className:"login-form__options__remember-label"},r.a.createElement("span",null,r.a.createElement("svg",{className:"login-form__options__check-icon"},r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-check")}))),r.a.createElement("span",null,"Remember me")),r.a.createElement("a",{href:"/",className:"login-form__options__forgot-password"},"Forgot password?")),r.a.createElement(se,{className:"medium-margin-bottom",type:"button",text:"Login"})),r.a.createElement(se,{className:"medium-margin-bottom",type:"anchor",text:"Don't have any account?"}),r.a.createElement("p",{className:"copyright-text"},"\xa9 2020 Tuanle207 All Rights Reserved")))}}]),a}(r.a.Component)),xe=Object(ce.a)({form:"login"})(Ie),Ce=Object(i.b)(null,{login:function(e,t){return function(){var a=Object(ue.a)(ie.a.mark((function a(n){var r;return ie.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fe.post("/api/v1/users/login",{email:e,password:t});case 2:"success"===(r=a.sent).data.status?(pe.a.set("jwt",r.data.token),n({type:p,payload:r.data.data.user}),de.emit("joinFriendRequest",{userId:r.data.data.user._id})):n({type:m,payload:r.data.message});case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()}})(xe),Re=function(e){Object(B.a)(a,e);var t=Object(z.a)(a);function a(){return Object(Y.a)(this,a),t.apply(this,arguments)}return Object(X.a)(a,[{key:"componentDidMount",value:function(){this.props.checkLoggedIn(),document.title="Teachat | Login"}},{key:"render",value:function(){return this.props.isLoggedIn?r.a.createElement($.a,{to:"/"}):this.props.UIState.loginLoading?r.a.createElement(ee.PointSpreadLoading,null):r.a.createElement("div",{className:"login-wrapper"},r.a.createElement(ne,null),r.a.createElement(Ce,null))}}]),a}(r.a.Component),Ue=Object(i.b)((function(e){return{isLoggedIn:e.authReducer.loggedIn,UIState:e.UIState}}),{checkLoggedIn:Ee})(Re),Fe=(a(385),a(386),a(387),a(388),function(e){Object(B.a)(a,e);var t=Object(z.a)(a);function a(){var e;Object(Y.a)(this,a);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).showFriendRequests=function(){e.props.showFriendRequests(!e.props.UIState.friendRequestsShowing)},e.showUserOperation=function(){e.props.showUserOperation(!e.props.UIState.userOperationShowing)},e.acceptFriend=function(t){e.props.acceptFriendRequest(t)},e.renderFriendRequest=function(){return 0===e.props.friendRequests.length?r.a.createElement("li",{className:"friend-list-no-item",style:{marginTop:"8rem"}},"No friend request."):e.props.friendRequests.map((function(t){var a=t.from,n=t._id;return r.a.createElement("li",{className:"notification__content--item",key:a.name},r.a.createElement("img",{src:"http://localhost:5000/img/user.jpg",alt:a.name}),r.a.createElement("div",null,r.a.createElement("p",null,a.nickName),r.a.createElement("p",null,a.name)),r.a.createElement("button",{onClick:e.acceptFriend.bind(null,n)},"Accept"),r.a.createElement("button",{onClick:e.props.removeFriendRequest.bind(null,n)},"Remove"))}))},e}return Object(X.a)(a,[{key:"componentDidMount",value:function(){de.on("friendRequest",this.props.receiveFriendRequest)}},{key:"componentDidMount",value:function(){this.props.currentUser&&this.props.getFriendRequest()}},{key:"render",value:function(){return r.a.createElement("div",{className:"profile"},r.a.createElement("figure",{className:"profile__card"},r.a.createElement("img",{src:"http://localhost:5000/img/user.jpg",alt:this.props.currentUser.name,className:"profile__card__user-icon",onClick:this.showUserOperation}),r.a.createElement("figcaption",{className:"profile__card__name"},this.props.currentUser.name)),r.a.createElement("a",{className:"notification",onClick:this.showFriendRequests},r.a.createElement("svg",{className:"notification__button ".concat(this.props.UIState.friendRequestsShowing?"notification__button--active":"")},r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-bullhorn")})),this.props.friendRequests.length>0?r.a.createElement("span",{className:"notification__text"},this.props.friendRequests.length):null),r.a.createElement("div",{className:this.props.UIState.friendRequestsShowing?"notification__content notification__content--active":"notification__content"},r.a.createElement("div",{className:"notification__wrapper"},r.a.createElement("p",null,"Friend Requests"),r.a.createElement("ul",{className:"notification__content--list"},this.renderFriendRequest()))),r.a.createElement("div",{className:"options ".concat(this.props.UIState.userOperationShowing?"options--active":"")},r.a.createElement("ul",{className:"options__list"},r.a.createElement("li",{className:"options__item"},r.a.createElement("svg",null,r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-radio-checked")})),r.a.createElement("span",null,"Change online status")),r.a.createElement("li",{className:"options__item"},r.a.createElement("svg",null,r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-user-tie")})),r.a.createElement("span",null,"Change profile picture")),r.a.createElement("li",{className:"options__item"},r.a.createElement("svg",null,r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-key")})),r.a.createElement("span",null,"Change Password")),r.a.createElement("li",{className:"options__item",onClick:this.props.logout},r.a.createElement("svg",null,r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-exit")})),r.a.createElement("span",null,"Logout")))))}}]),a}(r.a.Component)),qe={showFriendRequests:function(e){return function(t){t({type:C,payload:{friendRequestsShowing:e}}),t({type:R,payload:{userOperationShowing:!1}})}},showUserOperation:function(e){return function(t){t({type:R,payload:{userOperationShowing:e}}),t({type:C,payload:{friendRequestsShowing:!1}})}},getFriendRequest:function(){return function(){var e=Object(ue.a)(ie.a.mark((function e(t){var a,n;return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fe.get("/api/v1/users/friendRequest",{headers:ge()});case 3:"success"===(a=e.sent).data.status&&(n=a.data.data,t({type:j,payload:n})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t({type:h,payload:{error:"Internal Server Error!"}});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},logout:function(){return function(e){je(e);var t=fe.get("/api/v1/users/logout");ve(t,e,{success:{type:d},fail:{type:h,payload:{error:"Internal Server Error!"}}},!0)}},acceptFriendRequest:function(e){return function(){var t=Object(ue.a)(ie.a.mark((function t(a){var n,r,c;return ie.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fe.patch("/api/v1/users/friendRequest",{requestId:e},{headers:ge()});case 3:if("success"!==(n=t.sent).data.status){t.next=12;break}return a({type:k,payload:e}),r=n.data.data,a({type:f,payload:r}),t.next=10,fe.post("/api/v1/chats",{friendId:r},{headers:ge()});case 10:c=t.sent,a({type:E,payload:c.data.data});case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),a({type:h,payload:{error:"Internal Server Error!"}});case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e){return t.apply(this,arguments)}}()},receiveFriendRequest:function(e){return function(t){t({type:S,payload:e})}},removeFriendRequest:function(e){return function(){var t=Object(ue.a)(ie.a.mark((function t(a){return ie.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fe.delete("/api/v1/users/friendRequest/".concat(e),{headers:ge()});case 3:a({type:N,payload:e}),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),a({type:h,payload:{error:"Internal Server Error!"}});case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()},getChats:be},Le=Object(i.b)((function(e){return{currentUser:e.authReducer.user,UIState:e.UIState,friendRequests:e.friendRequests}}),qe)(Fe),Ae=(a(389),function(e){var t=e.color,a={};return t&&(a.fill=t),r.a.createElement("div",{className:"spinner"},r.a.createElement("svg",{className:"spinner__icon",style:a},r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-spinner")})))}),He=function(e,t){if(!e.latestMessage&&!t.latestMessage)return 0;if(!e.latestMessage)return 1;if(!t.latestMessage)return-1;var a=new Date(e.latestMessage.sentAt),n=new Date(t.latestMessage.sentAt);return a>n?-1:a<n?1:0},Me=function(e){return Object.keys(e).map((function(t){return e[t]}))},Te=function(e,t){return function(a){e(a),setTimeout((function(){t()}),100)}},De=function(e){return null===e||void 0===e||0===Object.keys(e).length&&e.constructor===Object},Pe=(a(390),function(e){Object(B.a)(a,e);var t=Object(z.a)(a);function a(){return Object(Y.a)(this,a),t.apply(this,arguments)}return Object(X.a)(a,[{key:"componentDidMount",value:function(){this.props.getChats()}},{key:"componentDidUpdate",value:function(){0===Object.keys(this.props.chats).length||this.props.currentChat||this.props.startChat(this.props.chats[Object.keys(this.props.chats)[0]])}},{key:"renderMessageSender",value:function(e){var t=null;return e.latestMessage&&(t=e.latestMessage.sender===this.props.currentUser._id?r.a.createElement("span",{className:"friends__card__text--message__current-user"},"You:\xa0"):null),t}},{key:"getFriend",value:function(e){var t=this;return e.participants.find((function(e){return e._id!==t.props.currentUser._id}))}},{key:"renderChats",value:function(){var e,t=this;return 0===Me(this.props.chats).length?r.a.createElement("li",{className:"chat-list-no-item"},"No Chat found."):(e=Me(this.props.chats),e.sort(He)).map((function(e){var a=t.getFriend(e),n="";return t.props.currentChat&&(n=a._id===t.getFriend(t.props.currentChat)._id?"friends__item--active":""),r.a.createElement("li",{onClick:t.props.startChat.bind(null,e),key:e._id,className:"friends__item ".concat(n)},r.a.createElement("figure",{className:"friends__card"},r.a.createElement("img",{src:"http://localhost:5000/img/user.jpg",alt:a.name,className:"friends__card__photo"}),r.a.createElement("figcaption",{className:"friends__card__text"},r.a.createElement("p",{className:"friends__card__text--name"},a.name),r.a.createElement("p",{className:"friends__card__text--message"},t.renderMessageSender(e),e.latestMessage?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:36,a="";if(e.length<=36)a=e;else if(" "!==e[t]&&e.includes(" ")){for(var n=t;" "!==e[n];)n--;a=e.substr(0,n)}else a=e.substr(0,t);return a=e.length>36?a+" ...":a}(e.latestMessage.text):null))))}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"friends"},this.props.UIState.chatsLoading?r.a.createElement(Ae,null):r.a.createElement("ul",{className:"friends__list"},this.renderChats()))}}]),a}(r.a.Component)),Ge=Object(i.b)((function(e){return{chats:e.chatsReducer,currentUser:e.authReducer.user,currentChat:e.currentChat,UIState:e.UIState}}),{getChats:be,startChat:function(e){return function(){var t=Object(ue.a)(ie.a.mark((function t(a,n){return ie.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return je(a),a({type:x,payload:{messagesLoading:!0}}),a({type:v,payload:e}),de.emit("join",{idChat:e._id}),t.next=6,_e(e._id,a,n);case 6:setTimeout((function(){a({type:x,payload:{messagesLoading:!1}})}),200);case 7:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()},resetMessagesLoading:function(){return function(e){e({type:x,payload:{messagesLoading:!1}})}}})(Pe),Ke=(a(391),function(e){Object(B.a)(a,e);var t=Object(z.a)(a);function a(){return Object(Y.a)(this,a),t.apply(this,arguments)}return Object(X.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"bottom-bar"},r.a.createElement("button",{className:"bottom-bar__button",onClick:this.props.showSearchPeople.bind(null,!0)},r.a.createElement("svg",{className:"bottom-bar__icon"},r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-user-plus")})),r.a.createElement("span",{className:"bottom-bar__text"},"Add friend")),r.a.createElement("button",{className:"bottom-bar__button"},r.a.createElement("svg",{className:"bottom-bar__icon"},r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-cog")})),r.a.createElement("span",{className:"bottom-bar__text"},"Settings")))}}]),a}(r.a.Component)),Qe=Object(i.b)((function(e){return{currentUser:e.authReducer.user,UIState:e.UIState}}),{showSearchPeople:Oe})(Ke),We=(a(392),a(148),function(e){Object(B.a)(a,e);var t=Object(z.a)(a);function a(){var e;Object(Y.a)(this,a);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).renderInput=function(t){var a=t.input;t.meta;return r.a.createElement("input",Object.assign({},a,{type:"text",className:"search__input",placeholder:"Type people name",id:"input-peopleSeacrhKeyword",autoFocus:"on",autoComplete:"off",onChange:Te(a.onChange,e.props.handleSubmit(e.onSubmit))}))},e.onSubmit=function(t){e.props.searchFriends(t.peopleSearchKeyword)},e}return Object(X.a)(a,[{key:"render",value:function(){return r.a.createElement("form",{onSubmit:this.props.handleSubmit(this.onSubmit),style:{display:"flex"},className:"search"},r.a.createElement("svg",{className:"search__icon"},r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-search")})),r.a.createElement(re.a,{name:"peopleSearchKeyword",component:this.renderInput}))}}]),a}(r.a.Component)),Ve=Object(ce.a)({form:"peopleSearch"})(We),Je=Object(i.b)(null,{searchFriends:Se})(Ve),Ye=(a(393),function(e){Object(B.a)(a,e);var t=Object(z.a)(a);function a(){var e;Object(Y.a)(this,a);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).isFriend=function(t){return e.props.user.friends.includes(t)},e.renderRelationOption=function(t,a){return e.isFriend(t)?r.a.createElement("svg",null,r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-user-check")})):a?r.a.createElement("svg",null,r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-checkmark")})):r.a.createElement("svg",{onClick:e.props.sendFriendRequest.bind(null,t)},r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-plus")}))},e}return Object(X.a)(a,[{key:"componentDidMount",value:function(){this.props.searchFriends()}},{key:"renderPeople",value:function(){var e=this;return this.props.people&&0!==this.props.people.length?this.props.people?this.props.people.map((function(t){return r.a.createElement("li",{className:"friend-list-item",key:t._id},r.a.createElement("img",{src:"http://localhost:5000/img/user.jpg",alt:t.nickName}),r.a.createElement("div",null,r.a.createElement("p",null,t.nickName),r.a.createElement("p",null,t.name)),e.renderRelationOption(t._id,t.friendRequested))})):void 0:r.a.createElement("li",{className:"friend-list-no-item"},"No friends found.")}},{key:"render",value:function(){return r.a.createElement("div",{className:"friend-list-box"},r.a.createElement("ul",{className:"friend-list"},this.renderPeople()))}}]),a}(r.a.Component)),Xe=Object(i.b)((function(e){return{people:e.peopleReducer,user:e.authReducer.user}}),{searchFriends:Se,sendFriendRequest:function(e){return function(){var t=Object(ue.a)(ie.a.mark((function t(a,n){var r;return ie.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r={from:n().authReducer.user._id,to:e},de.emit("sendFriendRequest",r),t.next=5,ke(n().form.peopleSearch.values.peopleSearchKeyword,a);case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),a({type:h,payload:{error:"Internal Server Error!"}});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,a){return t.apply(this,arguments)}}()}})(Ye),ze=function(e){Object(B.a)(a,e);var t=Object(z.a)(a);function a(){return Object(Y.a)(this,a),t.apply(this,arguments)}return Object(X.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"friend-search ".concat(this.props.UIState.searchPeopleShowing?"":"friend-search--inactive")},r.a.createElement("div",{className:"friend-search__title"},r.a.createElement("p",null,"Search people"),r.a.createElement("svg",{onClick:function(){return e.props.showSearchPeople(!1)}},r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-cross")}))),r.a.createElement(Je,null),r.a.createElement(Xe,null))}}]),a}(r.a.Component),Be=Object(i.b)((function(e){return{UIState:e.UIState}}),{showSearchPeople:Oe})(ze),Ze=function(e){Object(B.a)(a,e);var t=Object(z.a)(a);function a(){var e;Object(Y.a)(this,a);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).renderInput=function(t){var a=t.input;t.meta;return r.a.createElement("input",Object.assign({},a,{type:"text",className:"search__input",placeholder:"Type friend name",id:"input-chatSeacrhKeyword",autoFocus:"on",autoComplete:"off",onChange:Te(a.onChange,e.props.handleSubmit(e.onSubmit))}))},e.onSubmit=function(t){e.props.getChats(t.chatSearchKeyword)},e}return Object(X.a)(a,[{key:"render",value:function(){return r.a.createElement("form",{onSubmit:this.props.handleSubmit(this.onSubmit),className:"search"},r.a.createElement("svg",{className:"search__icon"},r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-search")})),r.a.createElement(re.a,{name:"chatSearchKeyword",component:this.renderInput}))}}]),a}(r.a.Component),$e=Object(ce.a)({form:"chatSearch"})(Ze),et=Object(i.b)(null,{getChats:be})($e),tt=function(e){Object(B.a)(a,e);var t=Object(z.a)(a);function a(){return Object(Y.a)(this,a),t.apply(this,arguments)}return Object(X.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"side-nav"},r.a.createElement(Le,null),r.a.createElement(et,null),r.a.createElement(Ge,null),r.a.createElement(Qe,null),this.props.UIState.searchPeopleShowing?r.a.createElement(Be,null):null)}}]),a}(r.a.Component),at=Object(i.b)((function(e){return{UIState:e.UIState}}),null)(tt),nt=(a(394),a(395),function(e){Object(B.a)(a,e);var t=Object(z.a)(a);function a(){return Object(Y.a)(this,a),t.apply(this,arguments)}return Object(X.a)(a,[{key:"render",value:function(){var e=this;if(!this.props.currentChat)return r.a.createElement("div",{className:"top-bar"});var t=this.props.currentChat.participants.find((function(t){return t._id!==e.props.user._id}));return r.a.createElement("div",{className:"top-bar"},r.a.createElement("figure",{className:"top-bar__card"},r.a.createElement("img",{src:"http://localhost:5000/img/user.jpg",alt:t.name,className:"top-bar__card__user-icon"}),r.a.createElement("figcation",{className:"top-bar__card__name"},t.name)),r.a.createElement("div",{className:"top-bar__live-contact"},r.a.createElement("svg",{className:"top-bar__icon"},r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-phone")})),r.a.createElement("svg",{className:"top-bar__icon"},r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-video-camera")})),r.a.createElement("svg",{className:"top-bar__icon"},r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-dots-three-vertical")}))))}}]),a}(r.a.Component)),rt=Object(i.b)((function(e){return{currentChat:e.currentChat,user:e.authReducer.user}}))(nt),ct=a(39),st=(a(396),function(e){Object(B.a)(a,e);var t=Object(z.a)(a);function a(){var e;Object(Y.a)(this,a);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).renderInput=function(t){var a=t.input;t.meta;return r.a.createElement("input",Object.assign({},a,{type:"text",className:"form-input__input",placeholder:"Write your message...",id:"input-message",autoFocus:"on",autoComplete:"off",onClick:e.props.showEmoji.bind(null,!1)}))},e.onSubmit=function(t){var a=t.message;a&&""!==a.trim()&&e.props.sendMessage({sentAt:new Date,chat:e.props.currentChat._id,sender:e.props.user._id,text:a})},e}return Object(X.a)(a,[{key:"render",value:function(){return r.a.createElement("form",{onSubmit:this.props.handleSubmit(this.onSubmit),className:"form-input"},r.a.createElement(re.a,{name:"message",component:this.renderInput}),r.a.createElement("div",{className:"form-input__options"},r.a.createElement("svg",{className:"form-input__icon",onClick:this.props.showEmoji.bind(null,!this.props.UIState.emojiShowing)},r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-smile")})),r.a.createElement("svg",{className:"form-input__icon"},r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-attachment")})),r.a.createElement("svg",{className:"form-input__icon",onClick:this.props.handleSubmit(this.onSubmit)},r.a.createElement("use",{xlinkHref:"".concat(we.a,"#icon-paper-plane")}))))}}]),a}(r.a.Component)),ot=Object(ce.a)({form:"chatInput",onSubmitSuccess:function(e,t){t(Object(ct.b)("chatInput"))}})(st),it=Object(i.b)((function(e){return{currentChat:e.currentChat,user:e.authReducer.user,UIState:e.UIState}}),{sendMessage:function(e){return function(){var t=Object(ue.a)(ie.a.mark((function t(a){return ie.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{a({type:_,payload:e}),de.emit("sendMessage",e)}catch(n){a({type:h,payload:{error:"Internal Server Error!"}})}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},showEmoji:ye})(ot),ut=(a(397),function(e){Object(B.a)(a,e);var t=Object(z.a)(a);function a(){var e;Object(Y.a)(this,a);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).ref=r.a.createRef(),e}return Object(X.a)(a,[{key:"componentDidMount",value:function(){de.on("message",this.props.receiveMessage)}},{key:"componentDidUpdate",value:function(e){this.ref.current&&(this.ref.current.scrollTop=this.ref.current.scrollHeight)}},{key:"renderMessages",value:function(){var e=this;return this.props.UIState.messagesLoading?r.a.createElement(Ae,null):De(this.props.messages)?r.a.createElement("ul",{className:"conversation__list--no-item"},"Make new friends to start chatting!"):this.props.currentChat&&De(this.props.messages[this.props.currentChat._id])?r.a.createElement("ul",{className:"conversation__list--no-item"},"No messages available. Start talking with your friend!"):r.a.createElement("ul",{className:"conversation__list"},function(e){if(e.length<=1)return[e];for(var t=e[0],a=[t],n=[],r=1;r<e.length;r++)e[r].sender!==t.sender?(e[r].sender!==t.sender&&(t=e[r],n.push(a),a=[t]),r===e.length-1&&n.push(a)):(a.push(e[r]),r===e.length-1&&n.push(a));return n}(this.props.messages[this.props.currentChat._id]).map((function(t){return t.map((function(t,a,n){var c;c=t.sender===e.props.user._id?"conversation__message--right":"conversation__message--left";var s=a===n.length-1?"medium-margin-bottom":"";return r.a.createElement("li",{key:t._id,className:"conversation__message ".concat(c," ").concat(s)},r.a.createElement("img",{src:"http://localhost:5000/img/user.jpg",alt:"Anathan Pham",className:"conversation__message__img"}),r.a.createElement("p",{className:"conversation__message__text"},t.text))}))})))}},{key:"render",value:function(){return r.a.createElement("div",{className:"conversation",ref:this.ref},this.renderMessages())}}]),a}(r.a.Component)),lt=Object(i.b)((function(e){return{messages:e.messages,currentChat:e.currentChat,user:e.authReducer.user,UIState:e.UIState}}),{receiveMessage:function(e){return function(t){t({type:y,payload:e})}}})(ut),pt=a(162),mt=(a(399),a(400),function(e){Object(B.a)(a,e);var t=Object(z.a)(a);function a(){var e;Object(Y.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).onEmojiClick=function(t){var a="";e.props.form&&e.props.form.chatInput&&e.props.form.chatInput.values&&(a=e.props.form.chatInput.values.message),e.props.showEmoji(!1),e.props.change("chatInput","message",a+t.native)},e}return Object(X.a)(a,[{key:"render",value:function(){var e=this.props.UIState.emojiShowing?"emoji-box--active":"";return r.a.createElement("div",{className:"emoji-box ".concat(e)},r.a.createElement(pt.a,{onClick:this.onEmojiClick}))}}]),a}(r.a.Component)),dt=Object(i.b)((function(e){return{UIState:e.UIState,form:e.form}}),(function(e){return Object(o.b)({change:ct.a,showEmoji:ye},e)}))(mt),ht=function(e){Object(B.a)(a,e);var t=Object(z.a)(a);function a(){return Object(Y.a)(this,a),t.apply(this,arguments)}return Object(X.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"chat"},r.a.createElement(rt,null),r.a.createElement(lt,null),r.a.createElement(dt,null),r.a.createElement(it,null))}}]),a}(r.a.Component),ft=function(e){Object(B.a)(a,e);var t=Object(z.a)(a);function a(){return Object(Y.a)(this,a),t.apply(this,arguments)}return Object(X.a)(a,[{key:"componentDidMount",value:function(){this.props.checkLoggedIn(),document.title="Teachat \u2014 Instant and secure chatting with your friends"}},{key:"render",value:function(){return this.props.isLoggedIn?r.a.createElement("div",{className:"content"},r.a.createElement(ne,null),r.a.createElement(at,null),r.a.createElement(ht,null)):r.a.createElement($.a,{to:"/login"})}}]),a}(r.a.Component),gt=Object(i.b)((function(e){return{isLoggedIn:e.authReducer.loggedIn}}),{checkLoggedIn:Ee})(ft),vt=function(e){Object(B.a)(a,e);var t=Object(z.a)(a);function a(){return Object(Y.a)(this,a),t.apply(this,arguments)}return Object(X.a)(a,[{key:"render",value:function(){return r.a.createElement(Z.a,null,r.a.createElement($.b,{path:"/login",exact:!0,component:Ue}),r.a.createElement($.b,{path:"/",exact:!0,component:gt}))}}]),a}(r.a.Component),Et=window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||o.d,bt=Object(o.e)(V,Et(Object(o.a)(J.a)));s.a.render(r.a.createElement(i.a,{store:bt},r.a.createElement(vt,null)),document.querySelector("#root"))}},[[191,1,2]]]);
//# sourceMappingURL=main.9f5a4004.chunk.js.map